<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>CentOS7.7部署k8s（3 master + 3 node + 1 client） | 后端云</title>
  <meta name="keywords" content=" CentOS7.7 , k8s ">
  <meta name="description" content="CentOS7.7部署k8s（3 master + 3 node + 1 client） | 后端云">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="description" content="penstack linux kernel NFV OPNFV MANO OPEN-O 虚拟机 容器 裸机 微服务 lambda计算 kubernetes 异构计算 人工智能">
<meta property="og:type" content="website">
<meta property="og:title" content="categories">
<meta property="og:url" content="https://www.backendcloud.cn/categories/index.html">
<meta property="og:site_name" content="后端云">
<meta property="og:description" content="penstack linux kernel NFV OPNFV MANO OPEN-O 虚拟机 容器 裸机 微服务 lambda计算 kubernetes 异构计算 人工智能">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2017-01-27T22:06:06.000Z">
<meta property="article:modified_time" content="2022-04-02T00:42:52.642Z">
<meta property="article:author" content="后端云">
<meta property="article:tag" content="penstack linux kernel NFV OPNFV MANO OPEN-O 虚拟机 容器 裸机 微服务 lambda计算 kubernetes 异构计算 人工智能">
<meta name="twitter:card" content="summary">


<link rel="icon" href="/img/avatar.jpg">

<link href="/css/style.css?v=1.1.0" rel="stylesheet">

<link href="/css/hl_theme/zenbum.css?v=1.1.0" rel="stylesheet">

<link href="//cdn.jsdelivr.net/npm/animate.css@4.1.0/animate.min.css" rel="stylesheet">

<script src="//cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<script src="/js/titleTip.js?v=1.1.0" ></script>

<script src="//cdn.jsdelivr.net/npm/highlightjs@9.16.2/highlight.pack.min.js"></script>
<script>
    hljs.initHighlightingOnLoad();
</script>

<script src="//cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js"></script>



<script src="//cdn.jsdelivr.net/npm/jquery.cookie@1.4.1/jquery.cookie.min.js" ></script>

<script src="/js/iconfont.js?v=1.1.0" ></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?2858b2d509d28416712739c9a6a31204";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
<meta name="generator" content="Hexo 5.2.0"></head>
<div style="display: none">
  <input class="theme_disqus_on" value="false">
  <input class="theme_preload_comment" value="">
  <input class="theme_blog_path" value="">
  <input id="theme_shortcut" value="true" />
  <input id="theme_highlight_on" value="true" />
  <input id="theme_code_copy" value="true" />
</div>



<body>
<aside class="nav">
    <div class="nav-left">
        <a href="/" class="avatar_target">
    <img class="avatar" src="/img/avatar.jpg" />
</a>
<div class="author">
    <span>后端云</span>
</div>

<div class="icon">
    
</div>




<ul>
    <li><div class="all active" data-rel="全部文章">全部文章<small>(109)</small></div></li>
    
        
            
            <li><div data-rel="边缘云">边缘云<small>(3)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="动态">动态<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="基础篇">基础篇<small>(2)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="敏捷">敏捷<small>(3)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="生活">生活<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="业界">业界<small>(6)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="云原生">云原生<small>(14)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="智能云">智能云<small>(5)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="自动化">自动化<small>(2)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Collectd">Collectd<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Java">Java<small>(3)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="NFV">NFV<small>(16)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Openstack_dev">Openstack_dev<small>(6)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Openstack_op">Openstack_op<small>(29)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Python">Python<small>(1)</small></div>
                
            </li>
            
        
    
        
            
            <li><div data-rel="Tools">Tools<small>(14)</small></div>
                
            </li>
            
        
    
</ul>
<div class="left-bottom">
    <div class="menus">
    
    
    
    
    </div>
    <div></div>
</div>
<input type="hidden" id="yelog_site_posts_number" value="109">

<div style="display: none">
    <span id="busuanzi_value_site_uv"></span>
    <span id="busuanzi_value_site_pv"></span>
</div>

    </div>
    <div class="nav-right">
        <div class="friends-area">
    <div class="friends-title">
        友情链接
        <i class="iconfont icon-left"></i>
    </div>
    <div class="friends-content">
        <ul>
            
        </ul>
    </div>
</div>
        <div class="title-list">
    <div class="right-top">
        <div id="default-panel">
            <i class="iconfont icon-search" data-title="搜索 快捷键 i"></i>
            <div class="right-title">全部文章</div>
            <i class="iconfont icon-file-tree" data-title="切换到大纲视图 快捷键 w"></i>
        </div>
        <div id="search-panel">
            <i class="iconfont icon-left" data-title="返回"></i>
            <input id="local-search-input" />
            <label class="border-line" for="input"></label>
            <i class="iconfont icon-case-sensitive" data-title="大小写敏感"></i>
            <i class="iconfont icon-tag" data-title="标签"></i>
        </div>
        <div id="outline-panel" style="display: none">
            <div class="right-title">大纲</div>
            <i class="iconfont icon-list" data-title="切换到文章列表"></i>
        </div>
    </div>

    <div class="tags-list">
    <input id="tag-search" />
    <div class="tag-wrapper">
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>4G</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>5G</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>安装</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>边缘计算</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>边缘云</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>参与</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>插件</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>产业趋势</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>产业需求</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>成熟</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>持续集成</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>存储</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>多级跳转</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>孵化</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>工具</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>管理体制</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>广告</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>归档</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>华为</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>会员</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>会员制</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>集成</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>脚本</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>开发</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>开源</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>美国</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>目标</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>内存</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>配置</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>破解</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>热迁移</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>日本</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>上游关系</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>生命周期</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>生态</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>隧道</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>提案</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>效率</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>印象笔记国内版</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>源码分析</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>云硬盘</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>云原生</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>运营商</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>中心云</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>转发</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>自动化测试</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>子项目</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>aggregation</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>AI</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ansible</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>API</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>async</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>available zone</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Board</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>bug</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Bug</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Capability</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CentOS7.7</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>centos8</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CI/CD</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Collectd</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>CPU</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>cpu-pinning</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>cpu绑定</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>cpu核绑定</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Cyborg</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>devops</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>docker</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Doctor</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>DSL</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ETSI</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>evacuate</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Fluentd</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>FPGA</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Game</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>gerrit</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>git</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>git flow</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Github Action</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>goland</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>google</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Gossip</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>GPU</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>HA</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>hosts</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>https</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Huge Page</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Idea</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ideaIU</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>InfluxDB</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Intel Clear Container</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>iperf3</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Java</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>JDK</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jenkins</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>jetbrains</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>JIRA</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>K3S</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>k8s</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>K8S</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Kata Containers</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>KSM</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>kubeconfig</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>KubeEdge</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Kubernetes</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Kubernetes API</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Load Balance</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>LVS</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>masakari</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Masakari</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>NB-IoT</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Notion</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Nova</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>nova-scheduler</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>noVNC</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>numa</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>NUMA</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Ocata</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>OOMkilled</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Openstack</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Openstack Ocata</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Openstack Pike</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>openstack token管理</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>OpenYurt</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>OPNFV Prediction</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>ovs</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>parameter</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>passthrough</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>PCI</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Pike</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>placement</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>PLG</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Pod</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>POWER</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>privileged</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Prometheus</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>pycharm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>PyCharm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Python</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>qemu</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>QQ</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Raft</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RAID</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>React</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Region</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>RT</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>selinux</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>serverless</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Serverless</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Serverwalker</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Service</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>spring-boot</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SR-IOV</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>sriov</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Stein</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Switch</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>SYS_TIME</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>systemd</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>template</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Tools</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>TSC</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>tunnel</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Typora</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vdbench</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vim</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>Vitrage</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>VM HA</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>vnc</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>VNFD</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>WebStorm</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>widget</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>windows</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>xshell</a>
            </li>
        
            <li class="article-tag-list-item">
                <i class="iconfont icon-tag"></i><a>yum</a>
            </li>
        
    </div>

</div>

    
    <nav id="title-list-nav">
        
        <a  class="全部文章 "
           href="/2022/04/02/20220401/"
           data-tag=""
           data-author="" >
            <span class="post-title" title="20220401">20220401</span>
            <span class="post-date" title="2022-04-02 13:22:41">2022/04/02</span>
        </a>
        
        <a  class="全部文章 Java "
           href="/2022/03/25/spring-boot-async-demo/"
           data-tag="spring-boot,async"
           data-author="" >
            <span class="post-title" title="spring-boot异步的example">spring-boot异步的example</span>
            <span class="post-date" title="2022-03-25 11:24:27">2022/03/25</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2022/02/25/github-action-demo/"
           data-tag="CI/CD,Github Action,React"
           data-author="" >
            <span class="post-title" title="试用Github Action CI/CD流程（创建一个React项目，并打包部署）">试用Github Action CI/CD流程（创建一个React项目，并打包部署）</span>
            <span class="post-date" title="2022-02-25 11:54:20">2022/02/25</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2022/01/06/notion-widget/"
           data-tag="Notion,widget"
           data-author="" >
            <span class="post-title" title="Notion的页面插入小控件Widget">Notion的页面插入小控件Widget</span>
            <span class="post-date" title="2022-01-06 11:06:12">2022/01/06</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2022/01/06/notion/"
           data-tag="Notion,印象笔记国内版"
           data-author="" >
            <span class="post-title" title="Notion笔记和印象笔记同时使用的分工">Notion笔记和印象笔记同时使用的分工</span>
            <span class="post-date" title="2022-01-06 10:28:42">2022/01/06</span>
        </a>
        
        <a  class="全部文章 生活 "
           href="/2022/01/06/switch/"
           data-tag="Switch,Game"
           data-author="" >
            <span class="post-title" title="Switch游戏推荐">Switch游戏推荐</span>
            <span class="post-date" title="2022-01-06 09:58:49">2022/01/06</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2021/12/16/idea-plugin/"
           data-tag="Idea,插件"
           data-author="" >
            <span class="post-title" title="Idea 插件推荐">Idea 插件推荐</span>
            <span class="post-date" title="2021-12-16 17:48:09">2021/12/16</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2021/12/01/PLG/"
           data-tag="Kubernetes,Pod,PLG"
           data-author="" >
            <span class="post-title" title="PLG 实现 Kubernetes Pod 日志收集和展示">PLG 实现 Kubernetes Pod 日志收集和展示</span>
            <span class="post-date" title="2021-12-01 17:48:46">2021/12/01</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2021/11/30/pod-log-collect/"
           data-tag="Kubernetes,Pod,Fluentd"
           data-author="" >
            <span class="post-title" title="Fluentd 实现 Kubernetes Pod 日志收集">Fluentd 实现 Kubernetes Pod 日志收集</span>
            <span class="post-date" title="2021-11-30 16:36:50">2021/11/30</span>
        </a>
        
        <a  class="全部文章 Java "
           href="/2021/11/23/java-memo/"
           data-tag="Java"
           data-author="" >
            <span class="post-title" title="Java项目开发中的点滴记录（1）">Java项目开发中的点滴记录（1）</span>
            <span class="post-date" title="2021-11-23 15:04:04">2021/11/23</span>
        </a>
        
        <a  class="全部文章 Java "
           href="/2021/11/23/jdkbug/"
           data-tag="JDK,bug"
           data-author="" >
            <span class="post-title" title="JDK bug - Encrypt Private Key failed  unrecognized algorithm name  PBEWithSHA1AndDESede">JDK bug - Encrypt Private Key failed  unrecognized algorithm name  PBEWithSHA1AndDESede</span>
            <span class="post-date" title="2021-11-23 14:22:24">2021/11/23</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2021/09/28/kubernetes-api/"
           data-tag="边缘计算,Kubernetes API,云原生,中心云,边缘云"
           data-author="" >
            <span class="post-title" title="在产品开发中调用Kubernetes API接口遇到的几个问题">在产品开发中调用Kubernetes API接口遇到的几个问题</span>
            <span class="post-date" title="2021-09-28 17:25:28">2021/09/28</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2021/09/26/git-flow/"
           data-tag="git flow,git"
           data-author="" >
            <span class="post-title" title="开始尝试使用git flow工作流">开始尝试使用git flow工作流</span>
            <span class="post-date" title="2021-09-26 15:32:59">2021/09/26</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2021/09/15/typora-auto-numbering/"
           data-tag="Typora,Tools"
           data-author="" >
            <span class="post-title" title="Mac版Typora 标题自动编号">Mac版Typora 标题自动编号</span>
            <span class="post-date" title="2021-09-15 17:36:23">2021/09/15</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2021/09/13/create-kubeconfig/"
           data-tag="kubeconfig"
           data-author="" >
            <span class="post-title" title="云管平台创建资源池租户功能的实现">云管平台创建资源池租户功能的实现</span>
            <span class="post-date" title="2021-09-13 14:22:18">2021/09/13</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2021/08/10/kubernetes-iperf3-2/"
           data-tag="Kubernetes,iperf3,Service"
           data-author="" >
            <span class="post-title" title="iperf3测试Kubernetes Service的四层性能（下）">iperf3测试Kubernetes Service的四层性能（下）</span>
            <span class="post-date" title="2021-08-10 07:06:01">2021/08/10</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2021/08/09/kubernetes-iperf3/"
           data-tag="Kubernetes,iperf3,Service"
           data-author="" >
            <span class="post-title" title="iperf3测试Kubernetes Service的四层性能（上）">iperf3测试Kubernetes Service的四层性能（上）</span>
            <span class="post-date" title="2021-08-09 17:06:01">2021/08/09</span>
        </a>
        
        <a  class="全部文章 边缘云 "
           href="/2021/03/12/edge2021/"
           data-tag="serverless,边缘计算,5G,4G,NB-IoT,AI"
           data-author="" >
            <span class="post-title" title="边缘计算2021年展望">边缘计算2021年展望</span>
            <span class="post-date" title="2021-03-12 09:41:42">2021/03/12</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2021/03/11/jetbrains-mac-m1/"
           data-tag="jetbrains,goland,ideaIU,pycharm,WebStorm,破解"
           data-author="" >
            <span class="post-title" title="jetbrains macbook m1版全家桶破解">jetbrains macbook m1版全家桶破解</span>
            <span class="post-date" title="2021-03-11 17:01:57">2021/03/11</span>
        </a>
        
        <a  class="全部文章 边缘云 "
           href="/2021/01/26/edge-think/"
           data-tag="serverless,边缘计算,FPGA,GPU"
           data-author="" >
            <span class="post-title" title="边缘计算的几点思考">边缘计算的几点思考</span>
            <span class="post-date" title="2021-01-26 17:11:34">2021/01/26</span>
        </a>
        
        <a  class="全部文章 边缘云 "
           href="/2021/01/21/kubernetes2edge/"
           data-tag="Kubernetes,K8S,K3S,OpenYurt,KubeEdge"
           data-author="" >
            <span class="post-title" title="K3S, OpenYurt, KubeEdge 主要差异">K3S, OpenYurt, KubeEdge 主要差异</span>
            <span class="post-date" title="2021-01-21 16:47:45">2021/01/21</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2020/05/27/k8s-op/"
           data-tag="k8s"
           data-author="" >
            <span class="post-title" title="k8s常用操作">k8s常用操作</span>
            <span class="post-date" title="2020-05-27 17:32:08">2020/05/27</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2020/05/22/k8s-cpubond/"
           data-tag="Kubernetes,k8s,cpu核绑定"
           data-author="" >
            <span class="post-title" title="k8s支持容器核绑定">k8s支持容器核绑定</span>
            <span class="post-date" title="2020-05-22 16:24:44">2020/05/22</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2020/05/22/k8s-capability/"
           data-tag="Kubernetes,k8s,Capability,SYS_TIME"
           data-author="" >
            <span class="post-title" title="k8s支持Capability机制">k8s支持Capability机制</span>
            <span class="post-date" title="2020-05-22 15:18:59">2020/05/22</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2020/05/22/pod-mem/"
           data-tag="Kubernetes,k8s,OOMkilled,privileged"
           data-author="" >
            <span class="post-title" title="k8s OOMkilled超出内存限制的容器">k8s OOMkilled超出内存限制的容器</span>
            <span class="post-date" title="2020-05-22 13:52:15">2020/05/22</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2020/04/16/centos7-7-k8s-3nodes-prometheus/"
           data-tag="CentOS7.7,k8s,Prometheus"
           data-author="" >
            <span class="post-title" title="CentOS7.7部署k8s + Prometheus（1 master + 2 node）">CentOS7.7部署k8s + Prometheus（1 master + 2 node）</span>
            <span class="post-date" title="2020-04-16 13:46:34">2020/04/16</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2020/04/13/centos7-7-k8s-7nodes/"
           data-tag="CentOS7.7,k8s"
           data-author="" >
            <span class="post-title" title="CentOS7.7部署k8s（3 master + 3 node + 1 client）">CentOS7.7部署k8s（3 master + 3 node + 1 client）</span>
            <span class="post-date" title="2020-04-13 13:46:34">2020/04/13</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2020/04/10/centos7-7-k8s-3nodes/"
           data-tag="CentOS7.7,k8s"
           data-author="" >
            <span class="post-title" title="CentOS7.7部署k8s（1 master + 2 node）">CentOS7.7部署k8s（1 master + 2 node）</span>
            <span class="post-date" title="2020-04-10 13:46:34">2020/04/10</span>
        </a>
        
        <a  class="全部文章 云原生 "
           href="/2020/03/16/centos8installdocker/"
           data-tag="docker,centos8"
           data-author="" >
            <span class="post-title" title="CentOS 8.0 安装docker 报错：Problem: package docker-ce-3:19.03.8-3.el7.x86_64 requires containerd.io &gt;= 1.2.2-3">CentOS 8.0 安装docker 报错：Problem: package docker-ce-3:19.03.8-3.el7.x86_64 requires containerd.io &gt;= 1.2.2-3</span>
            <span class="post-date" title="2020-03-16 16:04:21">2020/03/16</span>
        </a>
        
        <a  class="全部文章 Openstack_dev "
           href="/2020/01/09/masakari-task-code/"
           data-tag="VM HA,Openstack,Masakari,源码分析"
           data-author="" >
            <span class="post-title" title="Openstack Masakari task流程源码分析">Openstack Masakari task流程源码分析</span>
            <span class="post-date" title="2020-01-09 09:18:53">2020/01/09</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2020/01/01/openstackopmemo4/"
           data-tag="Openstack,devops"
           data-author="" >
            <span class="post-title" title="Openstack运维常见问题记录(4)">Openstack运维常见问题记录(4)</span>
            <span class="post-date" title="2020-01-01 20:28:32">2020/01/01</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2019/09/20/stein-deploy-problem/"
           data-tag="Stein"
           data-author="" >
            <span class="post-title" title="Openstack Stein 部署遇到的问题">Openstack Stein 部署遇到的问题</span>
            <span class="post-date" title="2019-09-20 18:49:06">2019/09/20</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2019/08/28/jetbrains/"
           data-tag="jetbrains,goland,ideaIU,pycharm,WebStorm,破解"
           data-author="" >
            <span class="post-title" title="jetbrains windows版全家桶破解">jetbrains windows版全家桶破解</span>
            <span class="post-date" title="2019-08-28 15:15:39">2019/08/28</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2019/08/27/tunnel/"
           data-tag="xshell,tunnel,隧道,工具"
           data-author="" >
            <span class="post-title" title="xshell隧道转发的三种类型">xshell隧道转发的三种类型</span>
            <span class="post-date" title="2019-08-27 15:25:01">2019/08/27</span>
        </a>
        
        <a  class="全部文章 业界 "
           href="/2019/06/15/huaweijpqa/"
           data-tag="华为,日本,美国"
           data-author="" >
            <span class="post-title" title="任正非5月18日接受日本媒体采访的中文纪要">任正非5月18日接受日本媒体采访的中文纪要</span>
            <span class="post-date" title="2019-06-15 13:02:34">2019/06/15</span>
        </a>
        
        <a  class="全部文章 业界 "
           href="/2019/05/21/huaweiyun/"
           data-tag="华为"
           data-author="" >
            <span class="post-title" title="华为云可能也要被美国釜底抽薪">华为云可能也要被美国釜底抽薪</span>
            <span class="post-date" title="2019-05-21 11:52:58">2019/05/21</span>
        </a>
        
        <a  class="全部文章 业界 "
           href="/2019/05/20/huaweivsa/"
           data-tag="华为"
           data-author="" >
            <span class="post-title" title="属于华为的荣耀时刻">属于华为的荣耀时刻</span>
            <span class="post-date" title="2019-05-20 18:28:25">2019/05/20</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2019/04/19/sriov2ovs/"
           data-tag="sriov,ovs,脚本"
           data-author="" >
            <span class="post-title" title="sriov计算节点转ovs计算节点脚本">sriov计算节点转ovs计算节点脚本</span>
            <span class="post-date" title="2019-04-19 16:50:16">2019/04/19</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2019/04/18/placement/"
           data-tag="placement"
           data-author="" >
            <span class="post-title" title="Openstack Placement">Openstack Placement</span>
            <span class="post-date" title="2019-04-18 09:14:54">2019/04/18</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2018/10/21/power/"
           data-tag="POWER"
           data-author="" >
            <span class="post-title" title="POWER架构服务器作为计算节点">POWER架构服务器作为计算节点</span>
            <span class="post-date" title="2018-10-21 16:21:52">2018/10/21</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2018/10/14/sriov/"
           data-tag="SR-IOV,passthrough"
           data-author="" >
            <span class="post-title" title="OpenStack实践SR-IOV计算节点">OpenStack实践SR-IOV计算节点</span>
            <span class="post-date" title="2018-10-14 05:15:24">2018/10/14</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2018/09/29/openstackopmemo3/"
           data-tag="Openstack,devops"
           data-author="" >
            <span class="post-title" title="Openstack运维常见问题记录(3)">Openstack运维常见问题记录(3)</span>
            <span class="post-date" title="2018-09-29 20:28:32">2018/09/29</span>
        </a>
        
        <a  class="全部文章 基础篇 "
           href="/2018/09/05/ceph/"
           data-tag="vdbench"
           data-author="" >
            <span class="post-title" title="ceph数据存储的几个概念">ceph数据存储的几个概念</span>
            <span class="post-date" title="2018-09-05 17:32:47">2018/09/05</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2018/08/28/openstackopmemo2/"
           data-tag="Openstack,devops"
           data-author="" >
            <span class="post-title" title="Openstack运维常见问题记录(2)">Openstack运维常见问题记录(2)</span>
            <span class="post-date" title="2018-08-28 14:48:42">2018/08/28</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2018/08/26/openstackopmemo/"
           data-tag="Openstack,devops"
           data-author="" >
            <span class="post-title" title="Openstack运维常见问题记录(1)">Openstack运维常见问题记录(1)</span>
            <span class="post-date" title="2018-08-26 18:38:42">2018/08/26</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2018/08/16/2concepts/"
           data-tag="aggregation,available zone,numa"
           data-author="" >
            <span class="post-title" title="Openstack两组容易混淆的概念">Openstack两组容易混淆的概念</span>
            <span class="post-date" title="2018-08-16 15:08:05">2018/08/16</span>
        </a>
        
        <a  class="全部文章 自动化 "
           href="/2018/07/14/serverwalker/"
           data-tag="Serverwalker,自动化测试,DSL"
           data-author="" >
            <span class="post-title" title="自动化测试工具Serverwalker介绍">自动化测试工具Serverwalker介绍</span>
            <span class="post-date" title="2018-07-14 11:52:51">2018/07/14</span>
        </a>
        
        <a  class="全部文章 Openstack_dev "
           href="/2018/07/13/cpupin/"
           data-tag="cpu绑定"
           data-author="" >
            <span class="post-title" title="Openstack中的虚拟机的cpu绑定">Openstack中的虚拟机的cpu绑定</span>
            <span class="post-date" title="2018-07-13 20:09:41">2018/07/13</span>
        </a>
        
        <a  class="全部文章 业界 "
           href="/2018/05/10/huawei/"
           data-tag="华为,运营商"
           data-author="" >
            <span class="post-title" title="华为的发展已越来越不需要运营商">华为的发展已越来越不需要运营商</span>
            <span class="post-date" title="2018-05-10 23:45:05">2018/05/10</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2018/04/14/pike-novnc/"
           data-tag="Pike,noVNC"
           data-author="" >
            <span class="post-title" title="OpenStack Pike dashboard noVNC 不能访问">OpenStack Pike dashboard noVNC 不能访问</span>
            <span class="post-date" title="2018-04-14 05:18:22">2018/04/14</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2018/04/14/pycharm2018/"
           data-tag="PyCharm"
           data-author="" >
            <span class="post-title" title="JetBrains PyCharm 2018.1.1 x64专业版永久激活">JetBrains PyCharm 2018.1.1 x64专业版永久激活</span>
            <span class="post-date" title="2018-04-14 04:47:29">2018/04/14</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2018/04/14/vmsystemddel/"
           data-tag="selinux,qemu,systemd"
           data-author="" >
            <span class="post-title" title="vm被systemd删除">vm被systemd删除</span>
            <span class="post-date" title="2018-04-14 04:30:35">2018/04/14</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2018/04/14/vmcantstart/"
           data-tag="selinux"
           data-author="" >
            <span class="post-title" title="虚拟机无法启动">虚拟机无法启动</span>
            <span class="post-date" title="2018-04-14 03:15:39">2018/04/14</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2018/01/23/rt-vm/"
           data-tag="RT"
           data-author="" >
            <span class="post-title" title="部署实时OpenStack实例">部署实时OpenStack实例</span>
            <span class="post-date" title="2018-01-23 16:28:28">2018/01/23</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2018/01/23/scheduler-win-linux/"
           data-tag="nova-scheduler"
           data-author="" >
            <span class="post-title" title="支持windows虚拟机和linux虚拟机分区调度">支持windows虚拟机和linux虚拟机分区调度</span>
            <span class="post-date" title="2018-01-23 14:40:11">2018/01/23</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/12/28/local-yum/"
           data-tag="yum"
           data-author="" >
            <span class="post-title" title="Openstack Pike本地yum源搭建">Openstack Pike本地yum源搭建</span>
            <span class="post-date" title="2017-12-28 22:20:40">2017/12/28</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/12/28/p7-4-shell/"
           data-tag="Openstack Pike,安装"
           data-author="" >
            <span class="post-title" title="脚本安装Openstack Pike">脚本安装Openstack Pike</span>
            <span class="post-date" title="2017-12-28 20:43:27">2017/12/28</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2017/12/08/kata-containers/"
           data-tag="Kata Containers,Intel Clear Container,Serverless"
           data-author="" >
            <span class="post-title" title="Kata Containers">Kata Containers</span>
            <span class="post-date" title="2017-12-08 00:27:10">2017/12/08</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2017/11/12/raft-gossip/"
           data-tag="Raft,Gossip"
           data-author="" >
            <span class="post-title" title="Raft算法和Gossip协议">Raft算法和Gossip协议</span>
            <span class="post-date" title="2017-11-12 12:34:11">2017/11/12</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/11/10/vitrage/"
           data-tag="Vitrage"
           data-author="" >
            <span class="post-title" title="Openstack Vitrage（根因分析）">Openstack Vitrage（根因分析）</span>
            <span class="post-date" title="2017-11-10 08:02:15">2017/11/10</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2017/11/08/RTOS/"
           data-tag="RT"
           data-author="" >
            <span class="post-title" title="实时操作系统">实时操作系统</span>
            <span class="post-date" title="2017-11-08 15:13:56">2017/11/08</span>
        </a>
        
        <a  class="全部文章 基础篇 "
           href="/2017/08/01/raid/"
           data-tag="RAID"
           data-author="" >
            <span class="post-title" title="RAID">RAID</span>
            <span class="post-date" title="2017-08-01 08:42:40">2017/08/01</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/07/31/vm-cpu/"
           data-tag="Nova,CPU"
           data-author="" >
            <span class="post-title" title="云主机的指令集配置">云主机的指令集配置</span>
            <span class="post-date" title="2017-07-31 05:05:20">2017/07/31</span>
        </a>
        
        <a  class="全部文章 业界 "
           href="/2017/07/20/yunyingshang-kongjian/"
           data-tag="运营商"
           data-author="" >
            <span class="post-title" title="AI大环境下的运营商">AI大环境下的运营商</span>
            <span class="post-date" title="2017-07-20 18:51:01">2017/07/20</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2017/07/20/cpu-pinning/"
           data-tag="cpu-pinning"
           data-author="" >
            <span class="post-title" title="cpu-pinning CPU绑定">cpu-pinning CPU绑定</span>
            <span class="post-date" title="2017-07-20 18:30:18">2017/07/20</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2017/07/20/numa/"
           data-tag="NUMA"
           data-author="" >
            <span class="post-title" title="NUMA 非一致性内存访问">NUMA 非一致性内存访问</span>
            <span class="post-date" title="2017-07-20 17:47:16">2017/07/20</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2017/07/19/vmem/"
           data-tag="KSM,Huge Page"
           data-author="" >
            <span class="post-title" title="内存虚拟化">内存虚拟化</span>
            <span class="post-date" title="2017-07-19 05:17:46">2017/07/19</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/07/04/resize-error/"
           data-tag="Nova"
           data-author="" >
            <span class="post-title" title="resize失败原因调查">resize失败原因调查</span>
            <span class="post-date" title="2017-07-04 10:20:06">2017/07/04</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/06/30/attach-yunyingpan/"
           data-tag="云硬盘"
           data-author="" >
            <span class="post-title" title="挂载云硬盘">挂载云硬盘</span>
            <span class="post-date" title="2017-06-30 05:16:38">2017/06/30</span>
        </a>
        
        <a  class="全部文章 Openstack_dev "
           href="/2017/06/28/ocata-nova-evacuate-bug/"
           data-tag="Nova,Ocata,Bug"
           data-author="" >
            <span class="post-title" title="Ocata nova evacuate bug">Ocata nova evacuate bug</span>
            <span class="post-date" title="2017-06-28 18:24:18">2017/06/28</span>
        </a>
        
        <a  class="全部文章 敏捷 "
           href="/2017/06/28/trigger-build/"
           data-tag="gerrit,jenkins,持续集成"
           data-author="" >
            <span class="post-title" title="gerrit触发jenkins执行脚本自动构建rpm包">gerrit触发jenkins执行脚本自动构建rpm包</span>
            <span class="post-date" title="2017-06-28 18:17:13">2017/06/28</span>
        </a>
        
        <a  class="全部文章 敏捷 "
           href="/2017/06/28/gerrit-install/"
           data-tag="gerrit"
           data-author="" >
            <span class="post-title" title="gerrit install">gerrit install</span>
            <span class="post-date" title="2017-06-28 15:51:07">2017/06/28</span>
        </a>
        
        <a  class="全部文章 敏捷 "
           href="/2017/06/27/jira-install/"
           data-tag="JIRA"
           data-author="" >
            <span class="post-title" title="JIRA安装">JIRA安装</span>
            <span class="post-date" title="2017-06-27 01:53:54">2017/06/27</span>
        </a>
        
        <a  class="全部文章 "
           href="/2017/06/22/compute-node-ha/"
           data-tag="HA,masakari"
           data-author="" >
            <span class="post-title" title="compute node ha 主流开源实现">compute node ha 主流开源实现</span>
            <span class="post-date" title="2017-06-22 09:16:48">2017/06/22</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/06/15/live-migration-fail/"
           data-tag="热迁移"
           data-author="" >
            <span class="post-title" title="热迁移失败总结">热迁移失败总结</span>
            <span class="post-date" title="2017-06-15 18:54:53">2017/06/15</span>
        </a>
        
        <a  class="全部文章 Collectd "
           href="/2017/06/15/collectd-influxdb/"
           data-tag="Collectd,InfluxDB"
           data-author="" >
            <span class="post-title" title="Collectd 和 InfluxDB 的部署和使用">Collectd 和 InfluxDB 的部署和使用</span>
            <span class="post-date" title="2017-06-15 06:47:53">2017/06/15</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/06/14/block-migrate/"
           data-tag="Nova,热迁移"
           data-author="" >
            <span class="post-title" title="本地存储条件下的热迁移">本地存储条件下的热迁移</span>
            <span class="post-date" title="2017-06-14 15:25:48">2017/06/14</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2017/06/14/doctor/"
           data-tag="Doctor"
           data-author="" >
            <span class="post-title" title="Doctor framework">Doctor framework</span>
            <span class="post-date" title="2017-06-14 11:51:04">2017/06/14</span>
        </a>
        
        <a  class="全部文章 Openstack_dev "
           href="/2017/06/10/add-quick-evacuate/"
           data-tag="VM HA,Nova"
           data-author="" >
            <span class="post-title" title="将快速疏散功能加入VM HA程序中">将快速疏散功能加入VM HA程序中</span>
            <span class="post-date" title="2017-06-10 03:27:36">2017/06/10</span>
        </a>
        
        <a  class="全部文章 Openstack_dev "
           href="/2017/06/08/force-down/"
           data-tag="Nova,evacuate"
           data-author="" >
            <span class="post-title" title="新增OpenStack NOVA API用于强制计算节点nova-compute服务down">新增OpenStack NOVA API用于强制计算节点nova-compute服务down</span>
            <span class="post-date" title="2017-06-08 20:11:17">2017/06/08</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/06/07/storage-arch/"
           data-tag="存储"
           data-author="" >
            <span class="post-title" title="vm挂载卷，镜像，vm实例的共享存储架构">vm挂载卷，镜像，vm实例的共享存储架构</span>
            <span class="post-date" title="2017-06-07 08:20:29">2017/06/07</span>
        </a>
        
        <a  class="全部文章 动态 "
           href="/2017/05/06/https/"
           data-tag="https"
           data-author="" >
            <span class="post-title" title="后端云站全部采用https连接">后端云站全部采用https连接</span>
            <span class="post-date" title="2017-05-06 11:03:57">2017/05/06</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/05/04/win-register/"
           data-tag="windows"
           data-author="" >
            <span class="post-title" title="windows虚拟机激活失败问题">windows虚拟机激活失败问题</span>
            <span class="post-date" title="2017-05-04 22:21:24">2017/05/04</span>
        </a>
        
        <a  class="全部文章 自动化 "
           href="/2017/05/03/ansible/"
           data-tag="ansible"
           data-author="" >
            <span class="post-title" title="ansible简单使用">ansible简单使用</span>
            <span class="post-date" title="2017-05-03 07:55:42">2017/05/03</span>
        </a>
        
        <a  class="全部文章 智能云 "
           href="/2017/05/02/pci-api/"
           data-tag="PCI,API"
           data-author="" >
            <span class="post-title" title="pci-api support">pci-api support</span>
            <span class="post-date" title="2017-05-02 10:11:54">2017/05/02</span>
        </a>
        
        <a  class="全部文章 智能云 "
           href="/2017/05/01/cyborg-agent/"
           data-tag="Cyborg"
           data-author="" >
            <span class="post-title" title="cyborg agent">cyborg agent</span>
            <span class="post-date" title="2017-05-01 17:49:47">2017/05/01</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/05/01/vm-mem/"
           data-tag="内存"
           data-author="" >
            <span class="post-title" title="获取虚机内存">获取虚机内存</span>
            <span class="post-date" title="2017-05-01 14:27:38">2017/05/01</span>
        </a>
        
        <a  class="全部文章 智能云 "
           href="/2017/05/01/fpag-user-case/"
           data-tag="FPGA"
           data-author="" >
            <span class="post-title" title="FPGA用户用例提案">FPGA用户用例提案</span>
            <span class="post-date" title="2017-05-01 13:39:58">2017/05/01</span>
        </a>
        
        <a  class="全部文章 智能云 "
           href="/2017/04/29/gpu-config-rst/"
           data-tag="GPU,配置"
           data-author="" >
            <span class="post-title" title="云环境中GPU配置">云环境中GPU配置</span>
            <span class="post-date" title="2017-04-29 18:49:59">2017/04/29</span>
        </a>
        
        <a  class="全部文章 业界 "
           href="/2017/03/10/yunying-huawei/"
           data-tag="华为,运营商"
           data-author="" >
            <span class="post-title" title="华为和运营商们">华为和运营商们</span>
            <span class="post-date" title="2017-03-10 21:25:44">2017/03/10</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2017/03/07/hosts-google/"
           data-tag="google,hosts"
           data-author="" >
            <span class="post-title" title="访问google">访问google</span>
            <span class="post-date" title="2017-03-07 01:14:05">2017/03/07</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/02/24/ocata-packstack/"
           data-tag="Openstack Ocata"
           data-author="" >
            <span class="post-title" title="Openstack Ocata初体验">Openstack Ocata初体验</span>
            <span class="post-date" title="2017-02-24 16:45:50">2017/02/24</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2017/02/17/qq-ad/"
           data-tag="QQ,广告"
           data-author="" >
            <span class="post-title" title="去QQ广告">去QQ广告</span>
            <span class="post-date" title="2017-02-17 03:41:34">2017/02/17</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2017/02/08/glance-regiontwo2one/"
           data-tag="Region"
           data-author="" >
            <span class="post-title" title="openstack两个region分别用各自glance服务-&gt;共用glance服务">openstack两个region分别用各自glance服务-&gt;共用glance服务</span>
            <span class="post-date" title="2017-02-08 16:51:34">2017/02/08</span>
        </a>
        
        <a  class="全部文章 Python "
           href="/2017/01/17/zh-google-python-styleguide/"
           data-tag="Python"
           data-author="" >
            <span class="post-title" title="google Python 风格指南（中文版）">google Python 风格指南（中文版）</span>
            <span class="post-date" title="2017-01-17 18:03:22">2017/01/17</span>
        </a>
        
        <a  class="全部文章 智能云 "
           href="/2017/01/07/cyborg_intro/"
           data-tag="Cyborg,Openstack"
           data-author="" >
            <span class="post-title" title="Openstack Cyborg 项目介绍">Openstack Cyborg 项目介绍</span>
            <span class="post-date" title="2017-01-07 00:38:19">2017/01/07</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2016/12/24/xshell-skill/"
           data-tag="xshell,隧道,效率,转发,多级跳转"
           data-author="" >
            <span class="post-title" title="xshell工具在开发中的使用技巧">xshell工具在开发中的使用技巧</span>
            <span class="post-date" title="2016-12-24 23:10:36">2016/12/24</span>
        </a>
        
        <a  class="全部文章 Tools "
           href="/2016/09/02/vim-python/"
           data-tag="vim"
           data-author="" >
            <span class="post-title" title="python，NFV项目开发--vim">python，NFV项目开发--vim</span>
            <span class="post-date" title="2016-09-02 19:35:02">2016/09/02</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2016/08/18/vncviewer-openstack-vm/"
           data-tag="vnc"
           data-author="" >
            <span class="post-title" title="网络不通的情况下，不通过dashboard，在未装图形化系统上查看openstack 创建的vm">网络不通的情况下，不通过dashboard，在未装图形化系统上查看openstack 创建的vm</span>
            <span class="post-date" title="2016-08-18 13:49:11">2016/08/18</span>
        </a>
        
        <a  class="全部文章 Openstack_op "
           href="/2016/07/05/lb/"
           data-tag="Load Balance,LVS"
           data-author="" >
            <span class="post-title" title="Load Balance(LVS实现方式)">Load Balance(LVS实现方式)</span>
            <span class="post-date" title="2016-07-05 23:10:25">2016/07/05</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2016/07/05/vnfd-template-para/"
           data-tag="VNFD,template,parameter"
           data-author="" >
            <span class="post-title" title="VNFD模板参数化">VNFD模板参数化</span>
            <span class="post-date" title="2016-07-05 22:57:33">2016/07/05</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2016/06/11/prediction/"
           data-tag="OPNFV Prediction"
           data-author="" >
            <span class="post-title" title="OPNFV Prediction">OPNFV Prediction</span>
            <span class="post-date" title="2016-06-11 16:11:10">2016/06/11</span>
        </a>
        
        <a  class="全部文章 Openstack_dev "
           href="/2016/06/11/token-manage/"
           data-tag="openstack token管理"
           data-author="" >
            <span class="post-title" title="openstack token管理">openstack token管理</span>
            <span class="post-date" title="2016-06-11 15:23:00">2016/06/11</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2015/12/20/project-life-cycle/"
           data-tag="生命周期,提案,孵化,成熟,集成,归档"
           data-author="" >
            <span class="post-title" title="OPNFV项目生命周期">OPNFV项目生命周期</span>
            <span class="post-date" title="2015-12-20 20:02:27">2015/12/20</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2015/12/20/system_membership/"
           data-tag="管理体制,会员制,会员,Board,TSC"
           data-author="" >
            <span class="post-title" title="OPNFV的管理体制和会员制">OPNFV的管理体制和会员制</span>
            <span class="post-date" title="2015-12-20 19:32:42">2015/12/20</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2015/12/19/introduction-4/"
           data-tag="开发,开源,参与"
           data-author="" >
            <span class="post-title" title="OPNFV简介(4) - 对所有人开放">OPNFV简介(4) - 对所有人开放</span>
            <span class="post-date" title="2015-12-19 16:16:06">2015/12/19</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2015/12/19/introduction-3/"
           data-tag="上游关系"
           data-author="" >
            <span class="post-title" title="OPNFV简介(3) - 和上游关系">OPNFV简介(3) - 和上游关系</span>
            <span class="post-date" title="2015-12-19 16:04:59">2015/12/19</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2015/12/19/introduction-2/"
           data-tag="子项目,ETSI,目标,生态"
           data-author="" >
            <span class="post-title" title="OPNFV简介(2) - overview">OPNFV简介(2) - overview</span>
            <span class="post-date" title="2015-12-19 15:54:34">2015/12/19</span>
        </a>
        
        <a  class="全部文章 NFV "
           href="/2015/12/18/introduction-1/"
           data-tag="产业趋势,产业需求"
           data-author="" >
            <span class="post-title" title="OPNFV简介(1) - 背景">OPNFV简介(1) - 背景</span>
            <span class="post-date" title="2015-12-18 00:44:16">2015/12/18</span>
        </a>
        
        <div id="no-item-tips">

        </div>
    </nav>
    <div id="outline-list">
    </div>
</div>
    </div>
    <div class="hide-list">
        <div class="semicircle" data-title="切换全屏 快捷键 s">
            <div class="brackets first"><</div>
            <div class="brackets">&gt;</div>
        </div>
    </div>
</aside>
<div id="post">
    <div class="pjax">
        <article id="post-centos7-7-k8s-7nodes" class="article article-type-post" itemscope itemprop="blogPost">
    
        <h1 class="article-title">CentOS7.7部署k8s（3 master + 3 node + 1 client）</h1>
    
    <div class="article-meta">
        
        
        
        <span class="book">
            <i class="iconfont icon-category"></i>
            
            
            <a  data-rel="云原生">云原生</a>
            
        </span>
        
        
        <span class="tag">
            <i class="iconfont icon-tag"></i>
            
            <a class="color5">CentOS7.7</a>
            
            <a class="color4">k8s</a>
            
        </span>
        
    </div>
    <div class="article-meta">
        
            发布时间 : <time class="date" title='最后更新: 2022-04-02 08:42:52'>2020-04-13 13:46</time>
        
    </div>
    <div class="article-meta">
        
        
        <span id="busuanzi_container_page_pv">
            阅读 :<span id="busuanzi_value_page_pv">
                <span class="count-comment">
                    <span class="spinner">
                      <div class="cube1"></div>
                      <div class="cube2"></div>
                    </span>
                </span>
            </span>
        </span>
        
        
    </div>
    
    <div class="toc-ref">
    
        <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87%EF%BC%88%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%EF%BC%89"><span class="toc-text">前期准备（所有节点）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E4%B8%BB%E6%9C%BA%E5%90%8D%EF%BC%88%E8%8B%A5%E5%AE%89%E8%A3%85os%E7%9A%84%E6%97%B6%E5%80%99%E5%B7%B2%E7%BB%8F%E4%BF%AE%E6%94%B9%E8%BF%87%EF%BC%8C%E5%88%99%E8%B7%B3%E8%BF%87%EF%BC%89"><span class="toc-text">修改主机名（若安装os的时候已经修改过，则跳过）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9hosts%E6%96%87%E4%BB%B6"><span class="toc-text">修改hosts文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%B8%B8%E7%94%A8%E5%9F%BA%E7%A1%80%E5%8C%85vim%EF%BC%8Cwget%EF%BC%8Cyum-utils%EF%BC%8Cdevice-mapper-persistent-data%EF%BC%8Clvm2%EF%BC%8Cbash-completion"><span class="toc-text">安装常用基础包vim，wget，yum-utils，device-mapper-persistent-data，lvm2，bash-completion</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99%EF%BC%8Cselinux%EF%BC%8Cswap"><span class="toc-text">关闭防火墙，selinux，swap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%8D%E5%AF%86%E7%99%BB%E9%99%86"><span class="toc-text">免密登陆</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85docker%EF%BC%88%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%EF%BC%89"><span class="toc-text">安装docker（所有节点）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AEdocker%E6%BA%90"><span class="toc-text">设置docker源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Docker-CE"><span class="toc-text">安装Docker CE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8docker"><span class="toc-text">启动docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F"><span class="toc-text">配置国内镜像加速</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81docker%E5%AE%89%E8%A3%85"><span class="toc-text">验证docker安装</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#keepalived%E5%AE%89%E8%A3%85"><span class="toc-text">keepalived安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#k8s%E5%AE%89%E8%A3%85%E5%89%8D%E7%9A%84%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%EF%BC%88%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%EF%BC%89"><span class="toc-text">k8s安装前的准备工作（所有节点）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0%E4%BF%AE%E6%94%B9"><span class="toc-text">内核参数修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9Cgroup-Driver"><span class="toc-text">修改Cgroup Driver</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E5%8A%A0%E8%BD%BDdocker"><span class="toc-text">重新加载docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AEkubernetes%E6%BA%90"><span class="toc-text">设置kubernetes源</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85k8s%EF%BC%88Master%E8%8A%82%E7%82%B9-work%E8%8A%82%E7%82%B9%EF%BC%89"><span class="toc-text">安装k8s（Master节点, work节点）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96Master-%E4%BB%85%E5%9C%A8master01%E8%8A%82%E7%82%B9%E6%89%A7%E8%A1%8C"><span class="toc-text">初始化Master(仅在master01节点执行)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#control-plane%E8%8A%82%E7%82%B9%E5%8A%A0%E5%85%A5%E9%9B%86%E7%BE%A4"><span class="toc-text">control plane节点加入集群</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#work%E8%8A%82%E7%82%B9%E5%8A%A0%E5%85%A5%E9%9B%86%E7%BE%A4"><span class="toc-text">work节点加入集群</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#client%E9%85%8D%E7%BD%AE"><span class="toc-text">client配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E9%AB%98%E5%8F%AF%E7%94%A8%E6%B5%8B%E8%AF%95%EF%BC%88%E5%9C%A8client%E8%8A%82%E7%82%B9%E6%89%A7%E8%A1%8C%EF%BC%89"><span class="toc-text">集群高可用测试（在client节点执行）</span></a></li></ol>
    
<style>
    .left-col .switch-btn,
    .left-col .switch-area {
        display: none;
    }
    .toc-level-3 i,
    .toc-level-3 ol {
        display: none !important;
    }
</style>
</div>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p><code>目录：</code>（可以按<code>w</code>快捷键切换大纲视图）<br><div class='inner-toc'><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E6%9C%9F%E5%87%86%E5%A4%87%EF%BC%88%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%EF%BC%89"><span class="toc-text">前期准备（所有节点）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E4%B8%BB%E6%9C%BA%E5%90%8D%EF%BC%88%E8%8B%A5%E5%AE%89%E8%A3%85os%E7%9A%84%E6%97%B6%E5%80%99%E5%B7%B2%E7%BB%8F%E4%BF%AE%E6%94%B9%E8%BF%87%EF%BC%8C%E5%88%99%E8%B7%B3%E8%BF%87%EF%BC%89"><span class="toc-text">修改主机名（若安装os的时候已经修改过，则跳过）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9hosts%E6%96%87%E4%BB%B6"><span class="toc-text">修改hosts文件</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E5%B8%B8%E7%94%A8%E5%9F%BA%E7%A1%80%E5%8C%85vim%EF%BC%8Cwget%EF%BC%8Cyum-utils%EF%BC%8Cdevice-mapper-persistent-data%EF%BC%8Clvm2%EF%BC%8Cbash-completion"><span class="toc-text">安装常用基础包vim，wget，yum-utils，device-mapper-persistent-data，lvm2，bash-completion</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B3%E9%97%AD%E9%98%B2%E7%81%AB%E5%A2%99%EF%BC%8Cselinux%EF%BC%8Cswap"><span class="toc-text">关闭防火墙，selinux，swap</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%8D%E5%AF%86%E7%99%BB%E9%99%86"><span class="toc-text">免密登陆</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85docker%EF%BC%88%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%EF%BC%89"><span class="toc-text">安装docker（所有节点）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AEdocker%E6%BA%90"><span class="toc-text">设置docker源</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85Docker-CE"><span class="toc-text">安装Docker CE</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8docker"><span class="toc-text">启动docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%85%8D%E7%BD%AE%E5%9B%BD%E5%86%85%E9%95%9C%E5%83%8F%E5%8A%A0%E9%80%9F"><span class="toc-text">配置国内镜像加速</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AA%8C%E8%AF%81docker%E5%AE%89%E8%A3%85"><span class="toc-text">验证docker安装</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#keepalived%E5%AE%89%E8%A3%85"><span class="toc-text">keepalived安装</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#k8s%E5%AE%89%E8%A3%85%E5%89%8D%E7%9A%84%E5%87%86%E5%A4%87%E5%B7%A5%E4%BD%9C%EF%BC%88%E6%89%80%E6%9C%89%E8%8A%82%E7%82%B9%EF%BC%89"><span class="toc-text">k8s安装前的准备工作（所有节点）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0%E4%BF%AE%E6%94%B9"><span class="toc-text">内核参数修改</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9Cgroup-Driver"><span class="toc-text">修改Cgroup Driver</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%87%8D%E6%96%B0%E5%8A%A0%E8%BD%BDdocker"><span class="toc-text">重新加载docker</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AEkubernetes%E6%BA%90"><span class="toc-text">设置kubernetes源</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%AE%89%E8%A3%85k8s%EF%BC%88Master%E8%8A%82%E7%82%B9-work%E8%8A%82%E7%82%B9%EF%BC%89"><span class="toc-text">安装k8s（Master节点, work节点）</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96Master-%E4%BB%85%E5%9C%A8master01%E8%8A%82%E7%82%B9%E6%89%A7%E8%A1%8C"><span class="toc-text">初始化Master(仅在master01节点执行)</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#control-plane%E8%8A%82%E7%82%B9%E5%8A%A0%E5%85%A5%E9%9B%86%E7%BE%A4"><span class="toc-text">control plane节点加入集群</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#work%E8%8A%82%E7%82%B9%E5%8A%A0%E5%85%A5%E9%9B%86%E7%BE%A4"><span class="toc-text">work节点加入集群</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#client%E9%85%8D%E7%BD%AE"><span class="toc-text">client配置</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E9%9B%86%E7%BE%A4%E9%AB%98%E5%8F%AF%E7%94%A8%E6%B5%8B%E8%AF%95%EF%BC%88%E5%9C%A8client%E8%8A%82%E7%82%B9%E6%89%A7%E8%A1%8C%EF%BC%89"><span class="toc-text">集群高可用测试（在client节点执行）</span></a></li></ol></div></p>
<p>VMware创建7个vm，规格2cpu 2G mem 200G disk，一个NAT网卡</p>
<p>环境说明：</p>
<p>主机名    操作系统版本    ip    备注<br>master01    Centos 7.7.1908    192.168.174.159    master主机<br>master02    Centos 7.7.1908    192.168.174.160    master主机<br>master03    Centos 7.7.1908    192.168.174.161    master主机<br>（VIP 192.168.174.200    在3个master节点上浮动）<br>work01    Centos 7.7.1908    192.168.174.162    worker节点<br>work02    Centos 7.7.1908    192.168.174.163    worker节点<br>work03    Centos 7.7.1908    192.168.174.164    worker节点<br>client    Centos 7.7.1908    192.168.174.165    client节点</p>
<p><img src="/images/centos7-7-k8s-7nodes/1.png" alt="jpg"></p>
<h1 id="前期准备（所有节点）"><a href="#前期准备（所有节点）" class="headerlink" title="前期准备（所有节点）"></a>前期准备（所有节点）</h1><h2 id="修改主机名（若安装os的时候已经修改过，则跳过）"><a href="#修改主机名（若安装os的时候已经修改过，则跳过）" class="headerlink" title="修改主机名（若安装os的时候已经修改过，则跳过）"></a>修改主机名（若安装os的时候已经修改过，则跳过）</h2><pre><code># hostnamectl set-hostname &lt;hostname&gt;</code></pre>
<h2 id="修改hosts文件"><a href="#修改hosts文件" class="headerlink" title="修改hosts文件"></a>修改hosts文件</h2><pre><code># cat &lt;&lt; EOF &gt;&gt; /etc/hosts
192.168.174.159 master01
192.168.174.160 master02
192.168.174.161 master03
192.168.174.162 work01
192.168.174.163 work02
192.168.174.164 work03
192.168.174.165 client
192.168.174.200 master
EOF</code></pre>
<h2 id="安装常用基础包vim，wget，yum-utils，device-mapper-persistent-data，lvm2，bash-completion"><a href="#安装常用基础包vim，wget，yum-utils，device-mapper-persistent-data，lvm2，bash-completion" class="headerlink" title="安装常用基础包vim，wget，yum-utils，device-mapper-persistent-data，lvm2，bash-completion"></a>安装常用基础包vim，wget，yum-utils，device-mapper-persistent-data，lvm2，bash-completion</h2><pre><code># yum install -y vim wget yum-utils device-mapper-persistent-data lvm2 bash-completion
# source /etc/profile.d/bash_completion.sh</code></pre>
<h2 id="关闭防火墙，selinux，swap"><a href="#关闭防火墙，selinux，swap" class="headerlink" title="关闭防火墙，selinux，swap"></a>关闭防火墙，selinux，swap</h2><pre><code># systemctl stop firewalld
# systemctl disable firewalld 
# setenforce 0
SELINUX=enforcing修改成SELINUX=disabled
# sed -i &#39;s/SELINUX=.*/SELINUX=disabled/g&#39; /etc/selinux/config
# swapoff -a
# sed -i.bak &#39;/swap/s/^/#/&#39; /etc/fstab</code></pre>
<h2 id="免密登陆"><a href="#免密登陆" class="headerlink" title="免密登陆"></a>免密登陆</h2><pre><code>第一个节点执行
# ssh-keygen -t rsa
回车回车到结束
秘钥同步至其他节点
ssh-copy-id -i /root/.ssh/id_rsa.pub root@&lt;其他节点&gt;
免密登陆测试
第一个节点执行
# ssh &lt;其他节点的ip&gt;
# ssh &lt;其他节点的hostname&gt;    </code></pre>
<h1 id="安装docker（所有节点）"><a href="#安装docker（所有节点）" class="headerlink" title="安装docker（所有节点）"></a>安装docker（所有节点）</h1><h2 id="设置docker源"><a href="#设置docker源" class="headerlink" title="设置docker源"></a>设置docker源</h2><pre><code># yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo</code></pre>
<a id="more"></a>

<h2 id="安装Docker-CE"><a href="#安装Docker-CE" class="headerlink" title="安装Docker CE"></a>安装Docker CE</h2><pre><code># yum list docker-ce --showduplicates | sort -r
# yum install -y docker-ce-18.09.6 docker-ce-cli-18.09.6 containerd.io</code></pre>
<h2 id="启动docker"><a href="#启动docker" class="headerlink" title="启动docker"></a>启动docker</h2><pre><code># systemctl start docker
# systemctl enable docker</code></pre>
<h2 id="配置国内镜像加速"><a href="#配置国内镜像加速" class="headerlink" title="配置国内镜像加速"></a>配置国内镜像加速</h2><p>登陆地址为：<a target="_blank" rel="noopener" href="https://cr.console.aliyun.com/">https://cr.console.aliyun.com</a> ,未注册的可以先注册阿里云账户<br>点击左下角的<code>镜像中心</code>的<code>镜像加速器</code></p>
<pre><code># mkdir -p /etc/docker
# sudo tee /etc/docker/daemon.json &lt;&lt;-&#39;EOF&#39;
&#123;
  &quot;registry-mirrors&quot;: [&quot;https://w6pljua0.mirror.aliyuncs.com&quot;]
&#125;
EOF 
# systemctl daemon-reload
# systemctl restart docker</code></pre>
<h2 id="验证docker安装"><a href="#验证docker安装" class="headerlink" title="验证docker安装"></a>验证docker安装</h2><pre><code># docker --version
# docker run hello-world</code></pre>
<h1 id="keepalived安装"><a href="#keepalived安装" class="headerlink" title="keepalived安装"></a>keepalived安装</h1><pre><code>master01, master02, master03分别执行
# yum -y install keepalived
master01上执行
# cat /etc/keepalived/keepalived.conf 
! Configuration File for keepalived
global_defs &#123;
   router_id master01
&#125;
vrrp_instance VI_1 &#123;
    state MASTER 
    interface ens33
    virtual_router_id 50
    priority 100
    advert_int 1
    authentication &#123;
        auth_type PASS
        auth_pass 1111
    &#125;
    virtual_ipaddress &#123;
        192.168.174.200
    &#125;
&#125;
# cat /etc/keepalived/keepalived.conf 
! Configuration File for keepalived
global_defs &#123;
   router_id master02
&#125;
vrrp_instance VI_1 &#123;
    state BACKUP 
    interface ens33
    virtual_router_id 50
    priority 90
    advert_int 1
    authentication &#123;
        auth_type PASS
        auth_pass 1111
    &#125;
    virtual_ipaddress &#123;
        192.168.174.200
    &#125;
&#125;
# cat /etc/keepalived/keepalived.conf 
! Configuration File for keepalived
global_defs &#123;
   router_id master03
&#125;
vrrp_instance VI_1 &#123;
    state BACKUP 
    interface ens33
    virtual_router_id 50
    priority 80
    advert_int 1
    authentication &#123;
        auth_type PASS
        auth_pass 1111
    &#125;
    virtual_ipaddress &#123;
        192.168.174.200
    &#125;
# service keepalived start
# systemctl enable keepalived    
vip查看
# ip a</code></pre>
<h1 id="k8s安装前的准备工作（所有节点）"><a href="#k8s安装前的准备工作（所有节点）" class="headerlink" title="k8s安装前的准备工作（所有节点）"></a>k8s安装前的准备工作（所有节点）</h1><h2 id="内核参数修改"><a href="#内核参数修改" class="headerlink" title="内核参数修改"></a>内核参数修改</h2><pre><code># cat &lt;&lt;EOF &gt;  /etc/sysctl.d/k8s.conf
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
EOF
# sysctl -p /etc/sysctl.d/k8s.conf</code></pre>
<h2 id="修改Cgroup-Driver"><a href="#修改Cgroup-Driver" class="headerlink" title="修改Cgroup Driver"></a>修改Cgroup Driver</h2><pre><code># vim /etc/docker/daemon.json
新增‘&quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;’
# cat /etc/docker/daemon.json 
&#123;
    &quot;registry-mirrors&quot;: [&quot;https://v16stybc.mirror.aliyuncs.com&quot;],
    &quot;exec-opts&quot;: [&quot;native.cgroupdriver=systemd&quot;]
&#125;</code></pre>
<h2 id="重新加载docker"><a href="#重新加载docker" class="headerlink" title="重新加载docker"></a>重新加载docker</h2><pre><code># systemctl daemon-reload
# systemctl restart docker
修改cgroupdriver是为了消除告警：
[WARNING IsDockerSystemdCheck]: detected &quot;cgroupfs&quot; as the Docker cgroup driver. The recommended driver is &quot;systemd&quot;. Please follow the guide at https://kubernetes.io/docs/setup/cri/</code></pre>
<h2 id="设置kubernetes源"><a href="#设置kubernetes源" class="headerlink" title="设置kubernetes源"></a>设置kubernetes源</h2><pre><code># cat &lt;&lt;EOF &gt; /etc/yum.repos.d/kubernetes.repo
[kubernetes]
name=Kubernetes
baseurl=https://mirrors.aliyun.com/kubernetes/yum/repos/kubernetes-el7-x86_64/
enabled=1
gpgcheck=1
repo_gpgcheck=1
gpgkey=https://mirrors.aliyun.com/kubernetes/yum/doc/yum-key.gpg https://mirrors.aliyun.com/kubernetes/yum/doc/rpm-package-key.gpg
EOF
# yum clean all
# yum -y makecache</code></pre>
<h1 id="安装k8s（Master节点-work节点）"><a href="#安装k8s（Master节点-work节点）" class="headerlink" title="安装k8s（Master节点, work节点）"></a>安装k8s（Master节点, work节点）</h1><pre><code># yum list kubelet --showduplicates | sort -r
# yum install -y kubelet-1.16.4 kubeadm-1.16.4 kubectl-1.16.4
启动kubelet并设置开机启动
# systemctl enable kubelet &amp;&amp; systemctl start kubelet
kubelet命令补全
# echo &quot;source &lt;(kubectl completion bash)&quot; &gt;&gt; ~/.bash_profile
# source .bash_profile 
编辑下载镜像的脚本
# cat image.sh
#!/bin/bash
url=registry.cn-hangzhou.aliyuncs.com/loong576
version=v1.16.4
images=(`kubeadm config images list --kubernetes-version=$version|awk -F &#39;/&#39; &#39;&#123;print $2&#125;&#39;`)
for imagename in $&#123;images[@]&#125; ; do
  docker pull $url/$imagename
  docker tag $url/$imagename k8s.gcr.io/$imagename
  docker rmi -f $url/$imagename
done 
# chmod u+x image.sh
# ./image.sh
# docker images
REPOSITORY                           TAG                 IMAGE ID            CREATED             SIZE
k8s.gcr.io/kube-proxy                v1.14.2             5c24210246bb        10 months ago       82.1MB
k8s.gcr.io/kube-apiserver            v1.14.2             5eeff402b659        10 months ago       210MB
k8s.gcr.io/kube-controller-manager   v1.14.2             8be94bdae139        10 months ago       158MB
k8s.gcr.io/kube-scheduler            v1.14.2             ee18f350636d        10 months ago       81.6MB
k8s.gcr.io/coredns                   1.3.1               eb516548c180        15 months ago       40.3MB
k8s.gcr.io/etcd                      3.3.10              2c4adeb21b4f        16 months ago       258MB
k8s.gcr.io/pause                     3.1                 da86e6ba6ca1        2 years ago         742kB</code></pre>
<h1 id="初始化Master-仅在master01节点执行"><a href="#初始化Master-仅在master01节点执行" class="headerlink" title="初始化Master(仅在master01节点执行)"></a>初始化Master(仅在master01节点执行)</h1><pre><code># cat kubeadm-config.yaml 
apiVersion: kubeadm.k8s.io/v1beta2
kind: ClusterConfiguration
kubernetesVersion: v1.16.4
apiServer:
  certSANs:    #填写所有kube-apiserver节点的hostname、IP、VIP
  - master01
  - master02
  - master03
  - work01
  - work02
  - work03
  - 192.168.174.159
  - 192.168.174.160
  - 192.168.174.161
  - 192.168.174.162
  - 192.168.174.163
  - 192.168.174.164
  - 192.168.174.200
controlPlaneEndpoint: &quot;192.168.174.200:6443&quot;
networking:
  podSubnet: &quot;10.244.0.0/16&quot;
# kubeadm init --config=kubeadm-config.yaml
[init] Using Kubernetes version: v1.16.4
[preflight] Running pre-flight checks
[preflight] Pulling images required for setting up a Kubernetes cluster
[preflight] This might take a minute or two, depending on the speed of your internet connection
[preflight] You can also perform this action in beforehand using &#39;kubeadm config images pull&#39;
[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;
[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;
[kubelet-start] Activating the kubelet service
[certs] Using certificateDir folder &quot;/etc/kubernetes/pki&quot;
[certs] Generating &quot;ca&quot; certificate and key
[certs] Generating &quot;apiserver&quot; certificate and key
[certs] apiserver serving cert is signed for DNS names [master01 kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local master01 master02 master03 work01 work02 work03] and IPs [10.96.0.1 192.168.174.159 192.168.174.200 192.168.174.159 192.168.174.160 192.168.174.161 192.168.174.162 192.168.174.163 192.168.174.164 192.168.174.200]
[certs] Generating &quot;apiserver-kubelet-client&quot; certificate and key
[certs] Generating &quot;front-proxy-ca&quot; certificate and key
[certs] Generating &quot;front-proxy-client&quot; certificate and key
[certs] Generating &quot;etcd/ca&quot; certificate and key
[certs] Generating &quot;etcd/server&quot; certificate and key
[certs] etcd/server serving cert is signed for DNS names [master01 localhost] and IPs [192.168.174.159 127.0.0.1 ::1]
[certs] Generating &quot;etcd/peer&quot; certificate and key
[certs] etcd/peer serving cert is signed for DNS names [master01 localhost] and IPs [192.168.174.159 127.0.0.1 ::1]
[certs] Generating &quot;etcd/healthcheck-client&quot; certificate and key
[certs] Generating &quot;apiserver-etcd-client&quot; certificate and key
[certs] Generating &quot;sa&quot; key and public key
[kubeconfig] Using kubeconfig folder &quot;/etc/kubernetes&quot;
[kubeconfig] Writing &quot;admin.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;kubelet.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;controller-manager.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;scheduler.conf&quot; kubeconfig file
[control-plane] Using manifest folder &quot;/etc/kubernetes/manifests&quot;
[control-plane] Creating static Pod manifest for &quot;kube-apiserver&quot;
[control-plane] Creating static Pod manifest for &quot;kube-controller-manager&quot;
[control-plane] Creating static Pod manifest for &quot;kube-scheduler&quot;
[etcd] Creating static Pod manifest for local etcd in &quot;/etc/kubernetes/manifests&quot;
[wait-control-plane] Waiting for the kubelet to boot up the control plane as static Pods from directory &quot;/etc/kubernetes/manifests&quot;. This can take up to 4m0s
[apiclient] All control plane components are healthy after 19.501964 seconds
[upload-config] Storing the configuration used in ConfigMap &quot;kubeadm-config&quot; in the &quot;kube-system&quot; Namespace
[kubelet] Creating a ConfigMap &quot;kubelet-config-1.16&quot; in namespace kube-system with the configuration for the kubelets in the cluster
[upload-certs] Skipping phase. Please see --upload-certs
[mark-control-plane] Marking the node master01 as control-plane by adding the label &quot;node-role.kubernetes.io/master=&#39;&#39;&quot;
[mark-control-plane] Marking the node master01 as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]
[bootstrap-token] Using token: l1x9vx.bbqycpviej5ya31s
[bootstrap-token] Configuring bootstrap tokens, cluster-info ConfigMap, RBAC Roles
[bootstrap-token] configured RBAC rules to allow Node Bootstrap tokens to post CSRs in order for nodes to get long term certificate credentials
[bootstrap-token] configured RBAC rules to allow the csrapprover controller automatically approve CSRs from a Node Bootstrap Token
[bootstrap-token] configured RBAC rules to allow certificate rotation for all node client certificates in the cluster
[bootstrap-token] Creating the &quot;cluster-info&quot; ConfigMap in the &quot;kube-public&quot; namespace
[addons] Applied essential addon: CoreDNS
[addons] Applied essential addon: kube-proxy

Your Kubernetes control-plane has initialized successfully!

To start using your cluster, you need to run the following as a regular user:

  mkdir -p $HOME/.kube
  sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
  sudo chown $(id -u):$(id -g) $HOME/.kube/config

You should now deploy a pod network to the cluster.
Run &quot;kubectl apply -f [podnetwork].yaml&quot; with one of the options listed at:
  https://kubernetes.io/docs/concepts/cluster-administration/addons/

You can now join any number of control-plane nodes by copying certificate authorities
and service account keys on each node and then running the following as root:

  kubeadm join 192.168.174.200:6443 --token l1x9vx.bbqycpviej5ya31s \
    --discovery-token-ca-cert-hash sha256:396670c9fa96a5866aaeedc2a69b767aa0d751c6d55c6f8e8bc37e8f230ec5f0 \
    --control-plane

Then you can join any number of worker nodes by running the following on each as root:

kubeadm join 192.168.174.200:6443 --token l1x9vx.bbqycpviej5ya31s \
    --discovery-token-ca-cert-hash sha256:396670c9fa96a5866aaeedc2a69b767aa0d751c6d55c6f8e8bc37e8f230ec5f0

如果初始化失败，可执行kubeadm reset后重新初始化
# kubeadm reset
# rm -rf $HOME/.kube/config  
加载环境变量
# echo &quot;export KUBECONFIG=/etc/kubernetes/admin.conf&quot; &gt;&gt; ~/.bash_profile
# source .bash_profile 
安装pod网络
# kubectl apply -f https://raw.githubusercontent.com/coreos/flannel/2140ac876ef134e0ed5af15c65e414cf26827915/Documentation/kube-flannel.yml
podsecuritypolicy.policy/psp.flannel.unprivileged created
clusterrole.rbac.authorization.k8s.io/flannel created
clusterrolebinding.rbac.authorization.k8s.io/flannel created
serviceaccount/flannel created
configmap/kube-flannel-cfg created
daemonset.apps/kube-flannel-ds-amd64 created
daemonset.apps/kube-flannel-ds-arm64 created
daemonset.apps/kube-flannel-ds-arm created
daemonset.apps/kube-flannel-ds-ppc64le created
daemonset.apps/kube-flannel-ds-s390x created</code></pre>
<p><a target="_blank" rel="noopener" href="https://raw.githubusercontent.com/coreos/flannel/2140ac876ef134e0ed5af15c65e414cf26827915/Documentation/kube-flannel.yml">https://raw.githubusercontent.com/coreos/flannel/2140ac876ef134e0ed5af15c65e414cf26827915/Documentation/kube-flannel.yml</a> 文件可能需要翻墙<br>也可点击下面链接下载，下载后解压缩<br>下载<a href="/files/centos7-7-k8s-7nodes/kube-flannel.tar.gz">kube-flannel.tar.gz</a></p>
<h1 id="control-plane节点加入集群"><a href="#control-plane节点加入集群" class="headerlink" title="control plane节点加入集群"></a>control plane节点加入集群</h1><pre><code>在master01上运行脚本cert-main-master.sh，将证书分发至master02和master03
# cat cert-main-master.sh 
USER=root # customizable
CONTROL_PLANE_IPS=&quot;192.168.174.160 192.168.174.161&quot;
for host in $&#123;CONTROL_PLANE_IPS&#125;; do
    scp /etc/kubernetes/pki/ca.crt &quot;$&#123;USER&#125;&quot;@$host:
    scp /etc/kubernetes/pki/ca.key &quot;$&#123;USER&#125;&quot;@$host:
    scp /etc/kubernetes/pki/sa.key &quot;$&#123;USER&#125;&quot;@$host:
    scp /etc/kubernetes/pki/sa.pub &quot;$&#123;USER&#125;&quot;@$host:
    scp /etc/kubernetes/pki/front-proxy-ca.crt &quot;$&#123;USER&#125;&quot;@$host:
    scp /etc/kubernetes/pki/front-proxy-ca.key &quot;$&#123;USER&#125;&quot;@$host:
    scp /etc/kubernetes/pki/etcd/ca.crt &quot;$&#123;USER&#125;&quot;@$host:etcd-ca.crt
    # Quote this line if you are using external etcd
    scp /etc/kubernetes/pki/etcd/ca.key &quot;$&#123;USER&#125;&quot;@$host:etcd-ca.key
done
# chmod u+x cert-main-master.sh
# ./cert-main-master.sh
在master02上运行脚本cert-other-master.sh，将证书移至指定目录
[root@master02 ~]# cat cert-other-master.sh 
USER=root # customizable
mkdir -p /etc/kubernetes/pki/etcd
mv /$&#123;USER&#125;/ca.crt /etc/kubernetes/pki/
mv /$&#123;USER&#125;/ca.key /etc/kubernetes/pki/
mv /$&#123;USER&#125;/sa.pub /etc/kubernetes/pki/
mv /$&#123;USER&#125;/sa.key /etc/kubernetes/pki/
mv /$&#123;USER&#125;/front-proxy-ca.crt /etc/kubernetes/pki/
mv /$&#123;USER&#125;/front-proxy-ca.key /etc/kubernetes/pki/
mv /$&#123;USER&#125;/etcd-ca.crt /etc/kubernetes/pki/etcd/ca.crt
# Quote this line if you are using external etcd
mv /$&#123;USER&#125;/etcd-ca.key /etc/kubernetes/pki/etcd/ca.key
[root@master02 ~]# chmod u+x cert-other-master.sh
[root@master02 ~]# ./cert-other-master.sh 
在master03上也运行脚本cert-other-master.sh
# ./cert-other-master.sh 
下面这几条命令在master01节点上执行
查看令牌
# kubeadm token list
发现之前初始化时的令牌已过期
生成新的令牌
# kubeadm token create
wob9v2.2t7fwzg3sdfvbe05
生成新的加密串
# openssl x509 -pubkey -in /etc/kubernetes/pki/ca.crt | openssl rsa -pubin -outform der 2&gt;/dev/null |    openssl dgst -sha256
396670c9fa96a5866aaeedc2a69b767aa0d751c6d55c6f8e8bc37e8f230ec5f0 
master02加入集群（在master02上执行）
# kubeadm join 192.168.174.200:6443 --token wob9v2.2t7fwzg3sdfvbe05 \
    --discovery-token-ca-cert-hash sha256:396670c9fa96a5866aaeedc2a69b767aa0d751c6d55c6f8e8bc37e8f230ec5f0 \
    --control-plane    
[preflight] Running pre-flight checks
[preflight] Reading configuration from the cluster...
[preflight] FYI: You can look at this config file with &#39;kubectl -n kube-system get cm kubeadm-config -oyaml&#39;
[preflight] Running pre-flight checks before initializing the new control plane instance
[preflight] Pulling images required for setting up a Kubernetes cluster
[preflight] This might take a minute or two, depending on the speed of your internet connection
[preflight] You can also perform this action in beforehand using &#39;kubeadm config images pull&#39;
[certs] Using certificateDir folder &quot;/etc/kubernetes/pki&quot;
[certs] Generating &quot;front-proxy-client&quot; certificate and key
[certs] Generating &quot;etcd/server&quot; certificate and key
[certs] etcd/server serving cert is signed for DNS names [master02 localhost] and IPs [192.168.174.160 127.0.0.1 ::1]
[certs] Generating &quot;etcd/peer&quot; certificate and key
[certs] etcd/peer serving cert is signed for DNS names [master02 localhost] and IPs [192.168.174.160 127.0.0.1 ::1]
[certs] Generating &quot;etcd/healthcheck-client&quot; certificate and key
[certs] Generating &quot;apiserver-etcd-client&quot; certificate and key
[certs] Generating &quot;apiserver&quot; certificate and key
[certs] apiserver serving cert is signed for DNS names [master02 kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local master01 master02 master03 work01 work02 work03] and IPs [10.96.0.1 192.168.174.160 192.168.174.200 192.168.174.159 192.168.174.160 192.168.174.161 192.168.174.162 192.168.174.163 192.168.174.164 192.168.174.200]
[certs] Generating &quot;apiserver-kubelet-client&quot; certificate and key
[certs] Valid certificates and keys now exist in &quot;/etc/kubernetes/pki&quot;
[certs] Using the existing &quot;sa&quot; key
[kubeconfig] Generating kubeconfig files
[kubeconfig] Using kubeconfig folder &quot;/etc/kubernetes&quot;
[kubeconfig] Writing &quot;admin.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;controller-manager.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;scheduler.conf&quot; kubeconfig file
[control-plane] Using manifest folder &quot;/etc/kubernetes/manifests&quot;
[control-plane] Creating static Pod manifest for &quot;kube-apiserver&quot;
[control-plane] Creating static Pod manifest for &quot;kube-controller-manager&quot;
[control-plane] Creating static Pod manifest for &quot;kube-scheduler&quot;
[check-etcd] Checking that the etcd cluster is healthy
[kubelet-start] Downloading configuration for the kubelet from the &quot;kubelet-config-1.16&quot; ConfigMap in the kube-system namespace
[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;
[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;
[kubelet-start] Activating the kubelet service
[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...
[etcd] Announced new etcd member joining to the existing etcd cluster
[etcd] Creating static Pod manifest for &quot;etcd&quot;
[etcd] Waiting for the new etcd member to join the cluster. This can take up to 40s
&#123;&quot;level&quot;:&quot;warn&quot;,&quot;ts&quot;:&quot;2020-04-13T17:04:13.333+0800&quot;,&quot;caller&quot;:&quot;clientv3/retry_interceptor.go:61&quot;,&quot;msg&quot;:&quot;retrying of unary invoker failed&quot;,&quot;target&quot;:&quot;passthrough:///https://192.168.174.160:2379&quot;,&quot;attempt&quot;:0,&quot;error&quot;:&quot;rpc error: code = DeadlineExceeded desc = context deadline exceeded&quot;&#125;
[upload-config] Storing the configuration used in ConfigMap &quot;kubeadm-config&quot; in the &quot;kube-system&quot; Namespace
[mark-control-plane] Marking the node master02 as control-plane by adding the label &quot;node-role.kubernetes.io/master=&#39;&#39;&quot;
[mark-control-plane] Marking the node master02 as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]

This node has joined the cluster and a new control plane instance was created:

* Certificate signing request was sent to apiserver and approval was received.
* The Kubelet was informed of the new secure connection details.
* Control plane (master) label and taint were applied to the new node.
* The Kubernetes control plane instances scaled up.
* A new etcd member was added to the local/stacked etcd cluster.

To start administering your cluster from this node, you need to run the following as a regular user:

        mkdir -p $HOME/.kube
        sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
        sudo chown $(id -u):$(id -g) $HOME/.kube/config

Run &#39;kubectl get nodes&#39; to see this node join the cluster.

master03加入集群（在master03上执行）
# kubeadm join 192.168.174.200:6443 --token wob9v2.2t7fwzg3sdfvbe05 \
    --discovery-token-ca-cert-hash sha256:396670c9fa96a5866aaeedc2a69b767aa0d751c6d55c6f8e8bc37e8f230ec5f0 \
    --control-plane
[preflight] Running pre-flight checks
[preflight] Reading configuration from the cluster...
[preflight] FYI: You can look at this config file with &#39;kubectl -n kube-system get cm kubeadm-config -oyaml&#39;
[preflight] Running pre-flight checks before initializing the new control plane instance
[preflight] Pulling images required for setting up a Kubernetes cluster
[preflight] This might take a minute or two, depending on the speed of your internet connection
[preflight] You can also perform this action in beforehand using &#39;kubeadm config images pull&#39;
[certs] Using certificateDir folder &quot;/etc/kubernetes/pki&quot;
[certs] Generating &quot;apiserver&quot; certificate and key
[certs] apiserver serving cert is signed for DNS names [master03 kubernetes kubernetes.default kubernetes.default.svc kubernetes.default.svc.cluster.local master01 master02 master03 work01 work02 work03] and IPs [10.96.0.1 192.168.174.161 192.168.174.200 192.168.174.159 192.168.174.160 192.168.174.161 192.168.174.162 192.168.174.163 192.168.174.164 192.168.174.200]
[certs] Generating &quot;apiserver-kubelet-client&quot; certificate and key
[certs] Generating &quot;front-proxy-client&quot; certificate and key
[certs] Generating &quot;etcd/peer&quot; certificate and key
[certs] etcd/peer serving cert is signed for DNS names [master03 localhost] and IPs [192.168.174.161 127.0.0.1 ::1]
[certs] Generating &quot;apiserver-etcd-client&quot; certificate and key
[certs] Generating &quot;etcd/server&quot; certificate and key
[certs] etcd/server serving cert is signed for DNS names [master03 localhost] and IPs [192.168.174.161 127.0.0.1 ::1]
[certs] Generating &quot;etcd/healthcheck-client&quot; certificate and key
[certs] Valid certificates and keys now exist in &quot;/etc/kubernetes/pki&quot;
[certs] Using the existing &quot;sa&quot; key
[kubeconfig] Generating kubeconfig files
[kubeconfig] Using kubeconfig folder &quot;/etc/kubernetes&quot;
[kubeconfig] Writing &quot;admin.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;controller-manager.conf&quot; kubeconfig file
[kubeconfig] Writing &quot;scheduler.conf&quot; kubeconfig file
[control-plane] Using manifest folder &quot;/etc/kubernetes/manifests&quot;
[control-plane] Creating static Pod manifest for &quot;kube-apiserver&quot;
[control-plane] Creating static Pod manifest for &quot;kube-controller-manager&quot;
[control-plane] Creating static Pod manifest for &quot;kube-scheduler&quot;
[check-etcd] Checking that the etcd cluster is healthy
[kubelet-start] Downloading configuration for the kubelet from the &quot;kubelet-config-1.16&quot; ConfigMap in the kube-system namespace
[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;
[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;
[kubelet-start] Activating the kubelet service
[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...
[etcd] Announced new etcd member joining to the existing etcd cluster
[etcd] Creating static Pod manifest for &quot;etcd&quot;
[etcd] Waiting for the new etcd member to join the cluster. This can take up to 40s
[upload-config] Storing the configuration used in ConfigMap &quot;kubeadm-config&quot; in the &quot;kube-system&quot; Namespace
[mark-control-plane] Marking the node master03 as control-plane by adding the label &quot;node-role.kubernetes.io/master=&#39;&#39;&quot;
[mark-control-plane] Marking the node master03 as control-plane by adding the taints [node-role.kubernetes.io/master:NoSchedule]

This node has joined the cluster and a new control plane instance was created:

* Certificate signing request was sent to apiserver and approval was received.
* The Kubelet was informed of the new secure connection details.
* Control plane (master) label and taint were applied to the new node.
* The Kubernetes control plane instances scaled up.
* A new etcd member was added to the local/stacked etcd cluster.

To start administering your cluster from this node, you need to run the following as a regular user:

        mkdir -p $HOME/.kube
        sudo cp -i /etc/kubernetes/admin.conf $HOME/.kube/config
        sudo chown $(id -u):$(id -g) $HOME/.kube/config

Run &#39;kubectl get nodes&#39; to see this node join the cluster.

为了在master02和master03上也能执行kubectl命令，master02和master03加载环境变量（以下3条命令分别在master02，master03上执行）
# scp master01:/etc/kubernetes/admin.conf /etc/kubernetes/
# echo &quot;export KUBECONFIG=/etc/kubernetes/admin.conf&quot; &gt;&gt; ~/.bash_profile
# source .bash_profile     
集群节点查看
# kubectl get nodes
NAME       STATUS   ROLES    AGE     VERSION
master01   Ready    master   29m     v1.16.4
master02   Ready    master   5m16s   v1.16.4
master03   Ready    master   4m3s    v1.16.4
# kubectl get pod -o wide -n kube-system
NAME                               READY   STATUS    RESTARTS   AGE     IP                NODE       NOMINATED NODE   READINESS GATES
coredns-5644d7b6d9-8slvg           1/1     Running   0          30m     10.244.0.2        master01   &lt;none&gt;           &lt;none&gt;
coredns-5644d7b6d9-pw8mz           1/1     Running   0          30m     10.244.0.3        master01   &lt;none&gt;           &lt;none&gt;
etcd-master01                      1/1     Running   0          29m     192.168.174.159   master01   &lt;none&gt;           &lt;none&gt;
etcd-master02                      1/1     Running   0          6m22s   192.168.174.160   master02   &lt;none&gt;           &lt;none&gt;
etcd-master03                      1/1     Running   0          5m9s    192.168.174.161   master03   &lt;none&gt;           &lt;none&gt;
kube-apiserver-master01            1/1     Running   0          29m     192.168.174.159   master01   &lt;none&gt;           &lt;none&gt;
kube-apiserver-master02            1/1     Running   0          6m22s   192.168.174.160   master02   &lt;none&gt;           &lt;none&gt;
kube-apiserver-master03            1/1     Running   0          5m9s    192.168.174.161   master03   &lt;none&gt;           &lt;none&gt;
kube-controller-manager-master01   1/1     Running   1          29m     192.168.174.159   master01   &lt;none&gt;           &lt;none&gt;
kube-controller-manager-master02   1/1     Running   0          6m22s   192.168.174.160   master02   &lt;none&gt;           &lt;none&gt;
kube-controller-manager-master03   1/1     Running   0          5m10s   192.168.174.161   master03   &lt;none&gt;           &lt;none&gt;
kube-flannel-ds-amd64-j48v5        1/1     Running   0          6m23s   192.168.174.160   master02   &lt;none&gt;           &lt;none&gt;
kube-flannel-ds-amd64-njhpb        1/1     Running   0          20m     192.168.174.159   master01   &lt;none&gt;           &lt;none&gt;
kube-flannel-ds-amd64-wxwdm        1/1     Running   0          5m10s   192.168.174.161   master03   &lt;none&gt;           &lt;none&gt;
kube-proxy-2tqqt                   1/1     Running   0          30m     192.168.174.159   master01   &lt;none&gt;           &lt;none&gt;
kube-proxy-l8cbn                   1/1     Running   0          5m10s   192.168.174.161   master03   &lt;none&gt;           &lt;none&gt;
kube-proxy-mcss8                   1/1     Running   0          6m23s   192.168.174.160   master02   &lt;none&gt;           &lt;none&gt;
kube-scheduler-master01            1/1     Running   1          29m     192.168.174.159   master01   &lt;none&gt;           &lt;none&gt;
kube-scheduler-master02            1/1     Running   0          6m23s   192.168.174.160   master02   &lt;none&gt;           &lt;none&gt;
kube-scheduler-master03            1/1     Running   0          5m9s    192.168.174.161   master03   &lt;none&gt;           &lt;none&gt;
所有control plane节点处于ready状态，所有的系统组件也正常。</code></pre>
<h1 id="work节点加入集群"><a href="#work节点加入集群" class="headerlink" title="work节点加入集群"></a>work节点加入集群</h1><pre><code>分别在3个work节点执行
# kubeadm join 192.168.174.200:6443 --token wob9v2.2t7fwzg3sdfvbe05 \
--discovery-token-ca-cert-hash sha256:396670c9fa96a5866aaeedc2a69b767aa0d751c6d55c6f8e8bc37e8f230ec5f0
[preflight] Running pre-flight checks
[preflight] Reading configuration from the cluster...
[preflight] FYI: You can look at this config file with &#39;kubectl -n kube-system get cm kubeadm-config -oyaml&#39;
[kubelet-start] Downloading configuration for the kubelet from the &quot;kubelet-config-1.16&quot; ConfigMap in the kube-system namespace
[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;
[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;
[kubelet-start] Activating the kubelet service
[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...

This node has joined the cluster:
* Certificate signing request was sent to apiserver and a response was received.
* The Kubelet was informed of the new secure connection details.

Run &#39;kubectl get nodes&#39; on the control-plane to see this node join the cluster.

集群节点查看
# kubectl get nodes 
NAME       STATUS     ROLES    AGE     VERSION
master01   Ready      master   33m     v1.16.4
master02   Ready      master   9m24s   v1.16.4
master03   Ready      master   8m11s   v1.16.4
work01     Ready      &lt;none&gt;   54s     v1.16.4
work02     NotReady   &lt;none&gt;   9s      v1.16.4
work03     NotReady   &lt;none&gt;   4s      v1.16.4</code></pre>
<h1 id="client配置"><a href="#client配置" class="headerlink" title="client配置"></a>client配置</h1><pre><code># mkdir -p /etc/kubernetes
# scp 192.168.174.159:/etc/kubernetes/admin.conf /etc/kubernetes/
# echo &quot;export KUBECONFIG=/etc/kubernetes/admin.conf&quot; &gt;&gt; ~/.bash_profile
# source .bash_profile 
# kubectl get nodes 
# kubectl get cs
# kubectl get po -o wide -n kube-system </code></pre>
<h1 id="集群高可用测试（在client节点执行）"><a href="#集群高可用测试（在client节点执行）" class="headerlink" title="集群高可用测试（在client节点执行）"></a>集群高可用测试（在client节点执行）</h1><pre><code>[root@master01 ~]# ip a|grep 200
    inet 192.168.174.200/32 scope global ens33
# kubectl get endpoints kube-controller-manager -n kube-system -o yaml |grep holderIdentity
    control-plane.alpha.kubernetes.io/leader: &#39;&#123;&quot;holderIdentity&quot;:&quot;master03_e1abdbd5-350c-4da0-9086-922ca883d67c&quot;,&quot;leaseDurationSeconds&quot;:15,&quot;acquireTime&quot;:&quot;2020-04-14T00:11:42Z&quot;,&quot;renewTime&quot;:&quot;2020-04-14T02:09:26Z&quot;,&quot;leaderTransitions&quot;:2&#125;&#39;
# kubectl get endpoints kube-scheduler -n kube-system -o yaml |grep holderIdentity
    control-plane.alpha.kubernetes.io/leader: &#39;&#123;&quot;holderIdentity&quot;:&quot;master01_6a213e1a-9dba-466b-b840-f483c214fb39&quot;,&quot;leaseDurationSeconds&quot;:15,&quot;acquireTime&quot;:&quot;2020-04-14T00:11:29Z&quot;,&quot;renewTime&quot;:&quot;2020-04-14T02:09:34Z&quot;,&quot;leaderTransitions&quot;:2&#125;&#39;</code></pre>
<p>组件名    所在节点<br>apiserver    master01<br>controller-manager    master03<br>scheduler    master01</p>
<pre><code>关闭master01
[root@master01 ~]# init 0
[root@master02 ~]# ip a|grep 200
    inet 192.168.174.200/32 scope global ens33
# kubectl get endpoints kube-controller-manager -n kube-system -o yaml |grep holderIdentity
    control-plane.alpha.kubernetes.io/leader: &#39;&#123;&quot;holderIdentity&quot;:&quot;master02_41b9bc77-ead4-4a56-81a0-09410d38c9d2&quot;,&quot;leaseDurationSeconds&quot;:15,&quot;acquireTime&quot;:&quot;2020-04-14T02:14:09Z&quot;,&quot;renewTime&quot;:&quot;2020-04-14T02:14:27Z&quot;,&quot;leaderTransitions&quot;:3&#125;&#39;
# kubectl get endpoints kube-scheduler -n kube-system -o yaml |grep holderIdentity
    control-plane.alpha.kubernetes.io/leader: &#39;&#123;&quot;holderIdentity&quot;:&quot;master03_70c057d9-d62b-4a5a-97b4-385b86bd716d&quot;,&quot;leaseDurationSeconds&quot;:15,&quot;acquireTime&quot;:&quot;2020-04-14T02:14:08Z&quot;,&quot;renewTime&quot;:&quot;2020-04-14T02:14:36Z&quot;,&quot;leaderTransitions&quot;:3&#125;&#39;</code></pre>
<p>组件名    所在节点<br>apiserver    master02<br>controller-manager    master02<br>scheduler    master03</p>
<pre><code># kubectl get nodes
NAME       STATUS     ROLES    AGE   VERSION
master01   NotReady   master   17h   v1.16.4
master02   Ready      master   17h   v1.16.4
master03   Ready      master   17h   v1.16.4
work01     Ready      &lt;none&gt;   17h   v1.16.4
work02     Ready      &lt;none&gt;   17h   v1.16.4
work03     Ready      &lt;none&gt;   17h   v1.16.4
master01状态为NotReady
# cat nginx-master.yaml 
apiVersion: apps/v1             #描述文件遵循extensions/v1beta1版本的Kubernetes API
kind: Deployment                #创建资源类型为Deployment
metadata:                       #该资源元数据
  name: nginx-master            #Deployment名称
spec:                           #Deployment的规格说明
  selector:
    matchLabels:
      app: nginx 
  replicas: 3                   #指定副本数为3
  template:                     #定义Pod的模板
    metadata:                   #定义Pod的元数据
      labels:                   #定义label（标签）
        app: nginx              #label的key和value分别为app和nginx
    spec:                       #Pod的规格说明
      containers:               
      - name: nginx             #容器的名称
        image: nginx:latest     #创建容器所使用的镜像    

# kubectl apply -f nginx-master.yaml
deployment.apps/nginx-master created
# kubectl get po -o wide
NAME                            READY   STATUS    RESTARTS   AGE     IP           NODE     NOMINATED NODE   READINESS GATES
nginx-master-75b7bfdb6b-fnk5n   1/1     Running   0          2m34s   10.244.3.4   work01   &lt;none&gt;           &lt;none&gt;
nginx-master-75b7bfdb6b-qzqr4   1/1     Running   0          2m34s   10.244.5.3   work03   &lt;none&gt;           &lt;none&gt;
nginx-master-75b7bfdb6b-t75bv   1/1     Running   0          2m34s   10.244.4.4   work02   &lt;none&gt;           &lt;none&gt;
当有一个control plane节点宕机时，VIP会发生漂移，集群各项功能不受影响。
在关闭master01的同时关闭master02，测试集群还能否正常对外服务。
[root@master02 ~]# init 0
[root@master03 ~]# ip a|grep 200
vip漂移至唯一的control plane：master03
# kubectl get endpoints kube-controller-manager -n kube-system -o yaml |grep holderIdentity
# kubectl get nodes
Unable to connect to the server: dial tcp 192.168.174.200:6443: connect: no route to host
etcd集群崩溃，整个k8s集群也不能正常对外服务。</code></pre>

      
       <hr><span style="font-style: italic;color: gray;"> 转载请注明来源，欢迎指出任何有错误或不够清晰的表达。可以邮件至 backendcloud@gmail.com </span>
    </div>
</article>







    




    </div>
    <div class="copyright">
        <div class="wechat_OA">
	<span>欢迎您扫一扫下面的微信公众号对"后端云"进行订阅！</span>
	<br>
    <!-- 这里添加你的二维码图片 -->
	<img src ="/img/wechat-dingyuehao.jpg">
</div>

<p class="footer-entry"><span class="miit">
                <img src="/img/gov.png" title="中华人民共和国工业和信息化部">
                <a target="_blank" rel="noopener" href="http://beian.miit.gov.cn/">苏ICP备15031601-2号</a>
        </span>
    
    ©2017-2022 后端云
</p>

    </div>
    <div class="full-toc">
        <button class="full" data-title="切换全屏 快捷键 s"><span class="min "></span></button>
<a class="" id="rocket" ></a>

    </div>
</div>

</body>
<script src="/js/jquery.pjax.js?v=1.1.0" ></script>

<script src="/js/script.js?v=1.1.0" ></script>
<script>
    var img_resize = 'default';
    function initArticle() {
        /*渲染对应的表格样式*/
        
            $("#post .pjax table").addClass("green_title");
        

        /*渲染打赏样式*/
        

        /*高亮代码块行号*/
        

        /*访问数量*/
        
        $.getScript("//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js");
        

        /*代码高亮，行号对齐*/
        $('.pre-numbering').css('line-height',$('.has-numbering').css('line-height'));

        
        
    }

    /*打赏页面隐藏与展示*/
    

</script>

<!--加入行号的高亮代码块样式-->

<!--自定义样式设置-->
<style>
    
    
    .nav {
        width: 542px;
    }
    .nav.fullscreen {
        margin-left: -542px;
    }
    .nav-left {
        width: 120px;
    }
    
    
    @media screen and (max-width: 1468px) {
        .nav {
            width: 492px;
        }
        .nav.fullscreen {
            margin-left: -492px;
        }
        .nav-left {
            width: 100px;
        }
    }
    
    
    @media screen and (max-width: 1024px) {
        .nav {
            width: 492px;
            margin-left: -492px
        }
        .nav.fullscreen {
            margin-left: 0;
        }
    }
    
    @media screen and (max-width: 426px) {
        .nav {
            width: 100%;
        }
        .nav-left {
            width: 100%;
        }
    }
    
    
    .nav-right .title-list nav a .post-title, .nav-right .title-list #local-search-result a .post-title {
        color: #383636;
    }
    
    
    .nav-right .title-list nav a .post-date, .nav-right .title-list #local-search-result a .post-date {
        color: #5e5e5f;
    }
    
    
    .nav-right nav a.hover, #local-search-result a.hover{
        background-color: #e2e0e0;
    }
    
    

    /*列表样式*/
    

    /* 背景图样式 */
    
    


    /*引用块样式*/
    

    /*文章列表背景图*/
    

    
</style>







</html>
